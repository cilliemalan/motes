pipelines:
  build:
    group: motes
    label_template: "${github[:8]}"
    locking: off
    materials:
      github:
        git: https://github.com/cilliemalan/motes.git
        branch: master
    stages:
      - checks:
          jobs:
            environment:
              tasks:
                - script: printenv
            docker:
              tasks:
                - script: "docker --version"
            kubernetes:
              tasks:
                - script: "kubectl version"
            terraform:
              tasks:
              - script: "terraform --version"
            node:
              tasks:
                - script: |
                    node --version
                    npm --version
      - prerequisites:
          jobs:
            npm:
              tasks:
                - script: |
                    cd web
                    npm install
      # - tests:
      #     jobs:
      #       runtests:
      #         - script: |
      #             cd web
      #             npm test